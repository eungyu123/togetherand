# Docker NestJS 개발 명령어

## 기본 명령어

```bash
# 이미지 캐시 없이 빌드
docker-compose -f docker-compose.dev.yml build --no-cache

# 백그라운드 실행
docker-compose -f docker-compose.dev.yml up -d

# 마이그레이션
docker-compose -f docker-compose.dev.yml exec app npm run migration:run

# 볼륨까지 삭제
docker-compose -f docker-compose.dev.yml down -v

# 윈도우 cd Documents\GitHub\make-friend-backend
# 맥북 cd Documents/make-friend-backend
docker-compose -f docker-compose.dev.yml logs -f app
```

## 마이그레이션 명령어

```bash
# 마이그레이션 생성 (엔티티 변경 후)
docker-compose -f docker-compose.dev.yml exec app npm run migration:generate -- src/database/migrations/InitDatabase

# 마이그레이션 실행
docker-compose -f docker-compose.dev.yml exec app npm run migration:run

# 마이그레이션 되돌리기
docker-compose -f docker-compose.dev.yml exec app npm run migration:revert

# 마이그레이션 상태 확인
docker-compose -f docker-compose.dev.yml exec app npm run migration:show

# 스키마 동기화 (개발용 - 데이터 손실 주의!)
docker-compose -f docker-compose.dev.yml exec app npm run schema:sync

# 스키마 삭제 (모든 테이블 삭제 - 주의!)
docker-compose -f docker-compose.dev.yml exec app npm run schema:drop
```

## 로컬에서 배포환경과 동일하게 테스트하는방법

```bash
# 1. 로컬에서 프로덕션 Docker로 테스트
docker-compose -f docker-compose.yml up --build

# 2. 또는 개발 환경에서 빌드 후 테스트
docker-compose -f docker-compose.dev.yml exec app npm run build
docker-compose -f docker-compose.dev.yml exec app node dist/main.js
```
